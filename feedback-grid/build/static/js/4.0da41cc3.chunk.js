(this["webpackJsonpfeedback-grid"]=this["webpackJsonpfeedback-grid"]||[]).push([[4],{31:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var c,o=function(){return Math.random().toString(36).substr(2,9)},i=function(){if(c||(c=localStorage.getItem("myUid")),c)return c;var e=o();return localStorage.setItem("myUid",e),e}},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},55:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var c=n(4),o=n(0),i=n.n(o),r=n(10),s=n(57),a=n(39),l=(n(41),function(e){return new RegExp("^[^A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02b8\u0300-\u0590\u0800-\u1fff\u2c00-\ufb1c\ufdfe-\ufe6f\ufefd-\uffff]*[\u0591-\u07ff\ufb1d-\ufdfd\ufe70-\ufefc]").test(e)}),u=n(2),d="/assets/icons/",j=function(e){var t=e.className,n=e.onNew,i=Object(o.useState)(!1),r=Object(c.a)(i,2),s=r[0],a=r[1],j=Object(o.useRef)(null),b=Object(o.useState)(""),f=Object(c.a)(b,2),g=f[0],h=f[1],O=function(e){e.preventDefault(),e.stopPropagation(),n(g),h("")};return Object(u.jsxs)("div",{className:"wrapper ".concat(t),children:[Object(u.jsx)("div",{className:"input-wrapper ".concat(s?"open":""),children:Object(u.jsx)("input",{type:"text",style:{direction:l(g)?"rtl":"ltr"},ref:j,placeholder:"Add new item",value:g,onKeyUp:function(e){13===e.keyCode&&O(e)},onChange:function(e){h(e.target.value)},onBlur:function(){return setTimeout((function(){return a(!1)}),200)},className:"c-input"})}),s?Object(u.jsx)("img",{src:"".concat(d,"send.png"),alt:"",onMouseDown:O,className:"send-btn"}):Object(u.jsx)("img",{src:"".concat(d,"plus.png"),alt:"",onMouseDown:function(e){e.preventDefault(),e.stopPropagation(),a(!0),j.current.focus()},className:"new-btn"})]})},b=(n(42),n(43),"/assets/icons/"),f=function(e){var t=e.dislikes,n=e.loves,c=e.celebrates,o=e.evils,i=e.onPick;return Object(u.jsxs)("div",{className:"reactions",children:[Object(u.jsxs)("div",{className:"reaction",onClick:function(){return i("loves")},children:[Object(u.jsx)("span",{children:n}),Object(u.jsx)("img",{src:"".concat(b,"heart-color.png"),alt:"heart"})]}),Object(u.jsxs)("div",{className:"reaction",onClick:function(){return i("dislikes")},children:[Object(u.jsx)("span",{children:t}),Object(u.jsx)("img",{src:"".concat(b,"dislike-color.png"),alt:"dislike"})]}),Object(u.jsxs)("div",{className:"reaction",onClick:function(){return i("celebrates")},children:[Object(u.jsx)("span",{children:c}),Object(u.jsx)("img",{src:"".concat(b,"confetti-color.png"),alt:"confetti"})]}),Object(u.jsxs)("div",{className:"reaction",onClick:function(){return i("evils")},children:[Object(u.jsx)("span",{children:o}),Object(u.jsx)("img",{src:"".concat(b,"devil-color.png"),alt:"evil"})]})]})},g=n(31),h=function(e){var t=e.value,n=e.reactions,c=e.votes,i=e.onReaction,r=e.createdBy,s=e.onDelete,a=e.opacityOnHightlight;console.log(n),console.log(c);var d=Object(o.useCallback)((function(e){var t=Object(g.b)(),o=c[t];o&&""!==o&&n[o]--,c[t]=e,n[e]++,i({reactions:n,votes:c})}),[i,c,n]);return Object(u.jsxs)("div",{className:"card",style:{opacity:a?"0.6":"1"},children:[r===Object(g.b)()&&Object(u.jsx)("div",{className:"card-remove",onClick:s,style:{right:l(t)?"unset":"1rem",left:l(t)?"1rem":"unset"},children:"x"}),Object(u.jsx)("div",{className:"card-body ".concat(l(t)?"rtl":""),children:t}),Object(u.jsx)("hr",{}),Object(u.jsx)("div",{className:"card-footer",children:Object(u.jsx)(f,{evils:n.evils,dislikes:n.dislikes,loves:n.loves,onPick:d,celebrates:n.celebrates})})]})},O=(n(44),function(e){var t=0;for(var n in e)t+=e[n];return t}),v=function(e){var t=e.title,n=e.icon,r=e.onUpdate,l=e.feedbacks,d=void 0===l?[]:l,b=e.style,f=void 0===b?{}:b,v=e.userCounter,p=Object(o.useRef)(null),m=Object(o.useState)(!1),k=Object(c.a)(m,2),x=k[0],w=k[1];i.a.useEffect((function(){var e=0;d.forEach((function(t){return e+=O(t.reactions)}));var t=v*d.length;w(t>0&&e/t>.9)}),[v,d]);return Object(u.jsxs)("div",{className:"col ".concat(x?"hightlight":""),style:f,children:[Object(u.jsxs)("div",{className:"top",children:[Object(u.jsx)("img",{src:"".concat("/assets/icons/").concat(n,".png"),alt:"",className:"icon"}),Object(u.jsx)("div",{className:"title",children:t})]}),Object(u.jsx)("div",{className:"body",ref:p,children:d.sort((function(e,t){return O(t.reactions)-O(e.reactions)})).map((function(e,t){return Object(u.jsx)(h,{value:e.value,onDelete:function(){return function(e){var t=Object(a.a)(d),n=t.findIndex((function(t){return t.cid===e}));t.splice(n,1),r(t)}(e.cid)},votes:e.votes,createdBy:e.createBy,reactions:e.reactions,opacityOnHightlight:x&&0===O(e.reactions),onReaction:function(t){return function(e,t){var n=e.reactions,c=e.votes,o=d.findIndex((function(e){return e.cid===t})),i=Object(a.a)(d);i[o]=Object(s.a)(Object(s.a)({},i[o]),{},{votes:c,reactions:n}),r(i)}(t,e.cid)}},e.cid)}))}),Object(u.jsx)("div",{className:"footer",children:Object(u.jsx)(j,{className:"add-input",onNew:function(e){if(""!==e){var t={value:e,cid:Object(g.a)(),createBy:Object(g.b)(),reactions:{evils:0,dislikes:0,loves:0,celebrates:0},votes:{}},n=d.concat(t);setTimeout((function(){p.current.scrollTop=p.current.scrollHeight})),r(n)}}})})]})},p=(n(45),n(12)),m=[{title:"Things I Loves",icon:"heart",id:"things_love"},{title:"Things I dislike",icon:"dislike",id:"things_dislike"},{title:"Things I wants to improves",icon:"improve",id:"things_improve"},{title:"New things I have",icon:"innovation",id:"things_new"}],k=window.innerWidth/2,x={col:window.innerWidth<480?{backgroundRepeat:"no-repeat, no-repeat",backgroundSize:"1.5rem, 1.5rem",backgroundPosition:"center right 0.5rem ,center left 0.5rem",backgroundImage:"url(".concat("","/assets/icons/right-arrow.png), url(").concat("","/assets/icons/left-arrow.png)")}:{},colFirst:window.innerWidth<480?{backgroundRepeat:"no-repeat",backgroundSize:"1.5rem",backgroundPosition:"center right 0.5rem ",backgroundImage:"url(".concat("","/assets/icons/right-arrow.png)")}:{},colLast:window.innerWidth<480?{backgroundRepeat:"no-repeat",backgroundSize:"1.5rem",backgroundPosition:"center left 0.5rem",backgroundImage:"url(".concat("","/assets/icons/left-arrow.png)")}:{}},w=function(e){var t=e.isLoading,n=e.findCol,c=e.onColUpdate,r=e.errorMessage,s=e.userCounter,a=Object(o.useRef)(null),l=Object(o.useCallback)((function(e){var t=a.current.scrollLeft,n=t%window.innerWidth,c=Math.floor(t/window.innerWidth);n>k?a.current.scrollTo({left:(c+1)*window.innerWidth,behavior:"smooth"}):a.current.scrollTo({left:c*window.innerWidth,behavior:"smooth"})}),[]);return i.a.useEffect((function(){a.current.addEventListener("touchend",l),a.current.scrollLeft=0}),[l]),Object(u.jsxs)(i.a.Fragment,{children:[Object(u.jsx)("div",{className:"grid",ref:a,children:t?Object(u.jsx)("div",{className:"loader"}):m.map((function(e,t){return Object(u.jsx)(v,{title:e.title,icon:e.icon,userCounter:s,style:0===t?x.colFirst:t===m.length-1?x.colLast:x.col,onUpdate:function(t){return c(e.id,t)},feedbacks:n(e.id)},e.id)}))}),Object(u.jsx)(p.a,{error:r})]})},C=n(1),N=n(56),y=Object(N.a)("https://feedback-grid.herokuapp.com"),S=function(e){var t=Object(o.useState)(),n=Object(c.a)(t,2),i=n[0],r=n[1],s=Object(o.useState)([]),l=Object(c.a)(s,2),u=l[0],d=l[1],j=Object(o.useState)(!0),b=Object(c.a)(j,2),f=b[0],g=b[1],h=Object(o.useState)(),O=Object(c.a)(h,2),v=O[0],p=O[1],m=Object(o.useState)(0),k=Object(c.a)(m,2),x=k[0],w=k[1],N=new URLSearchParams(Object(C.e)().search).get("mode"),S=Object(C.f)(),I=Object(o.useCallback)((function(e){fetch("".concat("https://feedback-grid.herokuapp.com","/api/grid/").concat(e)).then((function(e){return e.json()})).then((function(e){console.log(e.grid.cols),d(e.grid.cols)})).catch((function(e){"new"===N?R("We Could not fetch grid, please check you connection"):"join"===N&&S("/")})).finally((function(){return g(!1)}))}),[N,S]),T=Object(o.useCallback)((function(){null!==e?(r(e),I(e),y.emit("join",{room:e}),y.on("updateTable",(function(t){I(e)})),y.on("usersCount",(function(e){w(e)}))):R("Grid not found")}),[e,I]);Object(o.useEffect)((function(){T()}),[T]);var L=Object(o.useCallback)((function(e,t){var n=u;console.log(u);var c=n.find((function(t){return t.name===e}));c&&(d(Object(a.a)(n)),c.feedbacks=t,fetch("".concat("https://feedback-grid.herokuapp.com","/api/grid/").concat(i),{method:"POST",body:JSON.stringify({grid:{cols:n}}),headers:{"Content-Type":"application/json"}}).then((function(e){y.emit("updateRequest")})).catch((function(e){return console.log(e)})))}),[u,i]),R=function(e){p(e),setTimeout((function(){p(null)}),3e3)};return{isLoading:f,findCol:function(e){var t=u.find((function(t){return t.name===e}));return t?t.feedbacks:[]},onColUpdate:L,errorMessage:v,userCounter:x}};n(55),t.default=function(){var e=Object(C.g)().gid,t=S(e),n=t.isLoading,s=t.findCol,a=t.onColUpdate,l=t.errorMessage,d=t.userCounter,j=Object(o.useState)(!0),b=Object(c.a)(j,2),f=b[0],g=b[1];return i.a.useEffect((function(){var e=localStorage.getItem("visited");g(e)}),[]),Object(u.jsxs)(i.a.Fragment,{children:[Object(u.jsx)(r.a,{userCounter:d}),Object(u.jsx)(w,{isLoading:n,userCounter:d,findCol:s,onColUpdate:a,errorMessage:l}),window.innerWidth<480&&!f&&Object(u.jsxs)("div",{id:"instructions",onClick:function(){g(!0),localStorage.setItem("visited",!0)},children:[Object(u.jsx)("img",{src:"".concat("","/assets/icons/swipe.png"),alt:"swip"}),Object(u.jsx)("h4",{children:"You can swipe left or right to change the column."})]})]})}}}]);
//# sourceMappingURL=4.0da41cc3.chunk.js.map