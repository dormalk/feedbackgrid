(this["webpackJsonpfeedback-grid"]=this["webpackJsonpfeedback-grid"]||[]).push([[4],{31:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var c,i=function(){return Math.random().toString(36).substr(2,9)},r=function(){if(c||(c=localStorage.getItem("myUid")),c)return c;var e=i();return localStorage.setItem("myUid",e),e}},42:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},57:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var c=n(4),i=n(0),r=n.n(i),o=n(10),s=n(40),a=(n(42),function(e){return new RegExp("^[^A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02b8\u0300-\u0590\u0800-\u1fff\u2c00-\ufb1c\ufdfe-\ufe6f\ufefd-\uffff]*[\u0591-\u07ff\ufb1d-\ufdfd\ufe70-\ufefc]").test(e)}),l=n(2),u="/assets/icons/",d=function(e){var t=e.className,n=e.onNew,r=Object(i.useState)(!1),o=Object(c.a)(r,2),s=o[0],d=o[1],j=Object(i.useRef)(null),b=Object(i.useState)(""),f=Object(c.a)(b,2),h=f[0],g=f[1],O=function(e){e.preventDefault(),e.stopPropagation(),n(h),g("")};return Object(l.jsxs)("div",{className:"wrapper ".concat(t),children:[Object(l.jsx)("div",{className:"input-wrapper ".concat(s?"open":""),children:Object(l.jsx)("input",{type:"text",style:{direction:a(h)?"rtl":"ltr"},ref:j,placeholder:"Add new item",value:h,onKeyUp:function(e){13===e.keyCode&&O(e)},onChange:function(e){g(e.target.value)},onBlur:function(){return setTimeout((function(){return d(!1)}),200)},className:"c-input"})}),s?Object(l.jsx)("img",{src:"".concat(u,"send.png"),alt:"",onMouseDown:O,className:"send-btn"}):Object(l.jsx)("img",{src:"".concat(u,"plus.png"),alt:"",onMouseDown:function(e){e.preventDefault(),e.stopPropagation(),d(!0),j.current.focus()},className:"new-btn"})]})},j=n(37),b=n(43),f=(n(44),n(45),"/assets/icons/"),h=function(e){var t=e.dislikes,n=e.loves,c=e.celebrates,i=e.evils,r=e.onPick;return Object(l.jsxs)("div",{className:"reactions",children:[Object(l.jsxs)("div",{className:"reaction",onClick:function(){return r("loves")},children:[Object(l.jsx)("span",{children:n}),Object(l.jsx)("img",{src:"".concat(f,"heart-color.png"),alt:"heart"})]}),Object(l.jsxs)("div",{className:"reaction",onClick:function(){return r("dislikes")},children:[Object(l.jsx)("span",{children:t}),Object(l.jsx)("img",{src:"".concat(f,"dislike-color.png"),alt:"dislike"})]}),Object(l.jsxs)("div",{className:"reaction",onClick:function(){return r("celebrates")},children:[Object(l.jsx)("span",{children:c}),Object(l.jsx)("img",{src:"".concat(f,"confetti-color.png"),alt:"confetti"})]}),Object(l.jsxs)("div",{className:"reaction",onClick:function(){return r("evils")},children:[Object(l.jsx)("span",{children:i}),Object(l.jsx)("img",{src:"".concat(f,"devil-color.png"),alt:"evil"})]})]})},g=n(31),O={},p=function(e){var t=e.value,n=e.reactions,c=e.onReaction,r=e.createdBy,o=e.onDelete,s=e.opacityOnHightlight,u=e.cid,d=Object(i.useCallback)((function(e){var t=O[u];t&&""!==t&&n[t]--,n[e]++,O=Object(b.a)(Object(b.a)({},O),{},Object(j.a)({},u,e)),c(n)}),[c,n,u]);return Object(l.jsxs)("div",{className:"card",style:{opacity:s?"0.6":"1"},children:[r===Object(g.b)()&&Object(l.jsx)("div",{className:"card-remove",onClick:o,style:{right:a(t)?"unset":"1rem",left:a(t)?"1rem":"unset"},children:"x"}),Object(l.jsx)("div",{className:"card-body ".concat(a(t)?"rtl":""),children:t}),Object(l.jsx)("hr",{}),Object(l.jsx)("div",{className:"card-footer",children:Object(l.jsx)(h,{evils:n.evils,dislikes:n.dislikes,loves:n.loves,onPick:d,celebrates:n.celebrates})})]})},m=(n(46),function(e){var t=0;for(var n in e)t+=e[n];return t}),v=function(e){var t=e.title,n=e.icon,o=e.onUpdate,a=e.feedbacks,u=void 0===a?[]:a,j=e.style,b=void 0===j?{}:j,f=e.userCounter,h=Object(i.useRef)(null),O=Object(i.useState)(!1),v=Object(c.a)(O,2),k=v[0],x=v[1];r.a.useEffect((function(){var e=0;u.forEach((function(t){return e+=m(t.reactions)}));var t=f*u.length;x(t>0&&e/t>.9)}),[f,u]);return Object(l.jsxs)("div",{className:"col ".concat(k?"hightlight":""),style:b,children:[Object(l.jsxs)("div",{className:"top",children:[Object(l.jsx)("img",{src:"".concat("/assets/icons/").concat(n,".png"),alt:"",className:"icon"}),Object(l.jsx)("div",{className:"title",children:t})]}),Object(l.jsx)("div",{className:"body",ref:h,children:u.sort((function(e,t){return m(t.reactions)-m(e.reactions)})).map((function(e){return Object(l.jsx)(p,{value:e.value,cid:e.cid,onDelete:function(){return function(e){var t=Object(s.a)(u),n=t.findIndex((function(t){return t.cid===e}));t.splice(n,1),o(t)}(e.cid)},createdBy:e.createBy,reactions:e.reactions,opacityOnHightlight:k&&0===m(e.reactions),onReaction:function(t){return function(e,t){var n=u.findIndex((function(e){return e.cid===t})),c=Object(s.a)(u);c[n].reactions=e,o(c)}(t,e.cid)}},e.cid)}))}),Object(l.jsx)("div",{className:"footer",children:Object(l.jsx)(d,{className:"add-input",onNew:function(e){if(""!==e){var t={value:e,cid:Object(g.a)(),createBy:Object(g.b)(),reactions:{evils:0,dislikes:0,loves:0,celebrates:0}},n=u.concat(t);setTimeout((function(){h.current.scrollTop=h.current.scrollHeight})),o(n)}}})})]})},k=(n(47),n(12)),x=[{title:"Things I Loves",icon:"heart",id:"things_love"},{title:"Things I dislike",icon:"dislike",id:"things_dislike"},{title:"Things I wants to improves",icon:"improve",id:"things_improve"},{title:"New things I have",icon:"innovation",id:"things_new"}],w=window.innerWidth/2,C={col:window.innerWidth<480?{backgroundRepeat:"no-repeat, no-repeat",backgroundSize:"1.5rem, 1.5rem",backgroundPosition:"center right 0.5rem ,center left 0.5rem",backgroundImage:"url(".concat("","/assets/icons/right-arrow.png), url(").concat("","/assets/icons/left-arrow.png)")}:{},colFirst:window.innerWidth<480?{backgroundRepeat:"no-repeat",backgroundSize:"1.5rem",backgroundPosition:"center right 0.5rem ",backgroundImage:"url(".concat("","/assets/icons/right-arrow.png)")}:{},colLast:window.innerWidth<480?{backgroundRepeat:"no-repeat",backgroundSize:"1.5rem",backgroundPosition:"center left 0.5rem",backgroundImage:"url(".concat("","/assets/icons/left-arrow.png)")}:{}},N=function(e){var t=e.isLoading,n=e.findCol,c=e.onColUpdate,o=e.errorMessage,s=e.userCounter,a=Object(i.useRef)(null),u=Object(i.useCallback)((function(e){var t=a.current.scrollLeft,n=t%window.innerWidth,c=Math.floor(t/window.innerWidth);n>w?a.current.scrollTo({left:(c+1)*window.innerWidth,behavior:"smooth"}):a.current.scrollTo({left:c*window.innerWidth,behavior:"smooth"})}),[]);return r.a.useEffect((function(){a.current.addEventListener("touchend",u),a.current.scrollLeft=0}),[u]),Object(l.jsxs)(r.a.Fragment,{children:[Object(l.jsx)("div",{className:"grid",ref:a,children:t?Object(l.jsx)("div",{className:"loader"}):x.map((function(e,t){return Object(l.jsx)(v,{title:e.title,icon:e.icon,userCounter:s,style:0===t?C.colFirst:t===x.length-1?C.colLast:C.col,onUpdate:function(t){return c(e.id,t)},feedbacks:n(e.id)},e.id)}))}),Object(l.jsx)(k.a,{error:o})]})},y=n(1),S=n(58),I=Object(S.a)("https://feedback-grid.herokuapp.com"),T=function(e){var t=Object(i.useState)(),n=Object(c.a)(t,2),r=n[0],o=n[1],a=Object(i.useState)([]),l=Object(c.a)(a,2),u=l[0],d=l[1],j=Object(i.useState)(!0),b=Object(c.a)(j,2),f=b[0],h=b[1],g=Object(i.useState)(),O=Object(c.a)(g,2),p=O[0],m=O[1],v=Object(i.useState)(0),k=Object(c.a)(v,2),x=k[0],w=k[1],C=new URLSearchParams(Object(y.e)().search).get("mode"),N=Object(y.f)(),S=Object(i.useCallback)((function(e){fetch("".concat("https://feedback-grid.herokuapp.com","/api/grid/").concat(e)).then((function(e){return e.json()})).then((function(e){d(e.grid.cols)})).catch((function(e){"new"===C?R("We Could not fetch grid, please check you connection"):"join"===C&&N("/")})).finally((function(){return h(!1)}))}),[C,N]),T=Object(i.useCallback)((function(){null!==e?(o(e),S(e),I.emit("join",{room:e}),I.on("updateTable",(function(t){S(e)})),I.on("usersCount",(function(e){w(e)}))):R("Grid not found")}),[e,S]);Object(i.useEffect)((function(){T()}),[T]);var L=Object(i.useCallback)((function(e,t){var n=u,c=n.find((function(t){return t.name===e}));c&&(d(Object(s.a)(n)),c.feedbacks=t,fetch("".concat("https://feedback-grid.herokuapp.com","/api/grid/").concat(r),{method:"POST",body:JSON.stringify({grid:{cols:n}}),headers:{"Content-Type":"application/json"}}).then((function(e){I.emit("updateRequest")})).catch((function(e){return console.log(e)})))}),[u,r]),R=function(e){m(e),setTimeout((function(){m(null)}),3e3)};return{isLoading:f,findCol:function(e){var t=u.find((function(t){return t.name===e}));return t?t.feedbacks:[]},onColUpdate:L,errorMessage:p,userCounter:x}};n(57),t.default=function(){var e=Object(y.g)().gid,t=T(e),n=t.isLoading,s=t.findCol,a=t.onColUpdate,u=t.errorMessage,d=t.userCounter,j=Object(i.useState)(!0),b=Object(c.a)(j,2),f=b[0],h=b[1];return r.a.useEffect((function(){var e=localStorage.getItem("visited");h(e)}),[]),Object(l.jsxs)(r.a.Fragment,{children:[Object(l.jsx)(o.a,{userCounter:d}),Object(l.jsx)(N,{isLoading:n,userCounter:d,findCol:s,onColUpdate:a,errorMessage:u}),window.innerWidth<480&&!f&&Object(l.jsxs)("div",{id:"instructions",onClick:function(){h(!0),localStorage.setItem("visited",!0)},children:[Object(l.jsx)("img",{src:"".concat("","/assets/icons/swipe.png"),alt:"swip"}),Object(l.jsx)("h4",{children:"You can swipe left or right to change the column."})]})]})}}}]);
//# sourceMappingURL=4.24b55573.chunk.js.map